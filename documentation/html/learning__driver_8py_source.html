<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Machine Learning Final Project: learning_driver.py Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Machine Learning Final Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">learning_driver.py</div>  </div>
</div><!--header-->
<div class="contents">
<a href="learning__driver_8py.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="namespacelearning__driver.html">    1</a></span>&#160;<span class="comment">##</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"># </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"># @summary:   This script drives the supervised learning project for binary classification. It uses the data set generated in order to learn and validate the decision rules with extremely high accuracy (almost perfect classification of 100%).</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">#             Popular classification techniques, such as logistic regression, bayes multinomial classification, and kernel-based support vector machines (SVM) fail to classify accurately (with less than 60% correctness).</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"># </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"># @author: Carlos Jaramillo</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"># @author: Juan Pablo Munoz</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"># </span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"># Machine Learning Course at CUNY Graduate Center - Final Project - Fall 2014 - Prof. Robert Haralick</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"># </span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">from</span> __future__ <span class="keyword">import</span> division</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">import</span> common_tools</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">import</span> time</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">##</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"># </span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">#     Simple training (fitting) of the data set using the Naive Bayesian classifier.</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"># </span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">#     @param filename: the database filename path</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">#     @param porcentage_to_train: The percentage from the database dedicated for training. The complimentary percentage is used for testing.</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">#     </span></div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="namespacelearning__driver.html#ad2e2ed20567d88c2310e3d56f480ff92">   24</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacelearning__driver.html#ad2e2ed20567d88c2310e3d56f480ff92">learn_model_naive_bayes</a>(data_file_prefix, delimiter=&quot;,&quot;, percentage_to_train=90):</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    filename = <span class="stringliteral">&quot;./InputData/&quot;</span> + data_file_prefix + <span class="stringliteral">&quot;.csv&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    selected_features = <span class="keywordtype">None</span>  <span class="comment"># None will work with all the features. Example of selected features [0, 4, 7, 8] &lt;--- a list of indices</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    features_data, classifications = <a class="code" href="namespacecommon__tools.html#a7987ebb2fe78986ee5bd276b9ca23b54">common_tools.read_data</a>(filename, delimiter=delimiter, feature_indices=selected_features, num_components=10, dtype=<span class="stringliteral">&#39;uint8&#39;</span>, given_string_labels=<span class="keyword">True</span>, has_header=<span class="keyword">False</span>)</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="comment"># Partition the data in ordert to train the classifier</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    num_instances = len(classifications)</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    holdout_number = int(num_instances * percentage_to_train / 100.)  <span class="comment"># hold out percentage (%) of the dataset instances for testing</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    train_instances = features_data[0:holdout_number]</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    train_labels = classifications[0:holdout_number]</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    test_instances = features_data[holdout_number:]</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    test_labels = classifications[holdout_number:]</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment"># Fit the dataset using a Bayes classifier</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keyword">from</span> sklearn <span class="keyword">import</span> naive_bayes</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment"># Naive Bayes Model Construction</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment"># MultinomialNB &amp; Complement NB</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    mnb = naive_bayes.MultinomialNB()</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    mnb.fit(train_instances, train_labels)</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    mnb_classification_accuracy = mnb.score(test_instances, test_labels)</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    print(<span class="stringliteral">&quot;Classification accuracy of Multinomial Naive Bayes =&quot;</span>, mnb_classification_accuracy)</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    print(<span class="stringliteral">&quot;\tTraining class count: [A=%d], [B=%d]&quot;</span> % tuple(mnb.class_count_))</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">pass</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">##</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"># </span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">#     Reads the data set from the file name provided in order to perform learning and final classification test providing the resulting accuracy of correct classification.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"># </span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">#     @param data_file_prefix: The prefix of the data set file name</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">#     @param load_data_from_pickle: When set to True, a Python pickle (.pkl extension) will be used instead of the traditional comma separated valued (.csv extension) data set.</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">#     </span></div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="namespacelearning__driver.html#a271d5c1e1b4364940878a76fce303bdc">   56</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacelearning__driver.html#a271d5c1e1b4364940878a76fce303bdc">classify_dataset</a>(data_file_prefix, load_data_from_pickle=False):</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keyword">from</span> mate_learning <span class="keyword">import</span> MateFinder</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">if</span> load_data_from_pickle:</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        all_features_data, all_classes = <a class="code" href="namespacecommon__tools.html#a38d5594d132460ab544508a860c74840">common_tools.load_dataset_from_pickle</a>(data_file_prefix)</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        all_features_data, all_classes = <a class="code" href="namespacecommon__tools.html#a7987ebb2fe78986ee5bd276b9ca23b54">common_tools.read_data</a>(<span class="stringliteral">&quot;./InputData/&quot;</span> + data_file_prefix + <span class="stringliteral">&quot;.csv&quot;</span>, <span class="stringliteral">&quot;,&quot;</span>, \</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                        use_string_labels=<span class="keyword">False</span>, given_string_labels=<span class="keyword">True</span>, \</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                        num_components=10, dtype=<span class="stringliteral">&#39;uint8&#39;</span>, has_header=<span class="keyword">True</span>, shuffle_rows=<span class="keyword">True</span>)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <a class="code" href="namespacecommon__tools.html#ae5d41b7419e727e4389ae0a37f684a7f">common_tools.save_dataset_to_pickle</a>(all_features_data, all_classes, data_file_prefix)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    t_start = time.clock()</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    match_maker = MateFinder(all_features_data, all_classes, mating_size=2)</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment"># Learning phase</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    decision_rules_LUT, best_matings, relevant_components = match_maker.learn_by_mate_discovery()</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment"># Final test</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    final_accuracy = match_maker.compute_prediction_accuracy(best_matings, decision_rules_LUT, relevant_components)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    t_end = time.clock()</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    t_elapsed = t_end - t_start</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    print(<span class="stringliteral">&quot;_&quot;</span>*80)</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    print(<span class="stringliteral">&quot;FINAL Accuracy = %.2f%s&quot;</span> % (final_accuracy * 100., <span class="stringliteral">&quot;%&quot;</span>))</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    print(<span class="stringliteral">&quot;_&quot;</span>*80)</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    print(<span class="stringliteral">&quot;TOTAL elapsed time: %.9f s&quot;</span> % (t_elapsed))</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keywordflow">if</span> __name__ == <span class="stringliteral">&#39;__main__&#39;</span>:</div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="namespacelearning__driver.html#abd05f3b18d8cfd764807c2bc99cd70de">   86</a></span>&#160;    data_file_prefix = <span class="stringliteral">&quot;dataset-3rel_components-quantized_butterfly-2014-12-27&quot;</span>  <span class="comment"># relevant_features = [0, 1, 8]</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="namespacelearning__driver.html#a5246f10c0d1e0b4f4df3597928bfbe22">   88</a></span>&#160;    test_against_MNB = <span class="keyword">False</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">if</span> test_against_MNB:</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <a class="code" href="namespacelearning__driver.html#ad2e2ed20567d88c2310e3d56f480ff92">learn_model_naive_bayes</a>(data_file_prefix, delimiter=<span class="stringliteral">&quot;,&quot;</span>, percentage_to_train=50)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        print(<span class="stringliteral">&quot;~&quot;</span>*80)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="namespacelearning__driver.html#a271d5c1e1b4364940878a76fce303bdc">classify_dataset</a>(data_file_prefix, load_data_from_pickle=<span class="keyword">True</span>)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">pass</span></div>
<div class="ttc" id="namespacecommon__tools_html_a38d5594d132460ab544508a860c74840"><div class="ttname"><a href="namespacecommon__tools.html#a38d5594d132460ab544508a860c74840">common_tools.load_dataset_from_pickle</a></div><div class="ttdeci">def load_dataset_from_pickle</div><div class="ttdef"><b>Definition:</b> <a href="common__tools_8py_source.html#l00051">common_tools.py:51</a></div></div>
<div class="ttc" id="namespacelearning__driver_html_ad2e2ed20567d88c2310e3d56f480ff92"><div class="ttname"><a href="namespacelearning__driver.html#ad2e2ed20567d88c2310e3d56f480ff92">learning_driver.learn_model_naive_bayes</a></div><div class="ttdeci">def learn_model_naive_bayes</div><div class="ttdoc">Simple training (fitting) of the data set using the Naive Bayesian classifier. </div><div class="ttdef"><b>Definition:</b> <a href="learning__driver_8py_source.html#l00024">learning_driver.py:24</a></div></div>
<div class="ttc" id="namespacecommon__tools_html_a7987ebb2fe78986ee5bd276b9ca23b54"><div class="ttname"><a href="namespacecommon__tools.html#a7987ebb2fe78986ee5bd276b9ca23b54">common_tools.read_data</a></div><div class="ttdeci">def read_data</div><div class="ttdef"><b>Definition:</b> <a href="common__tools_8py_source.html#l00065">common_tools.py:65</a></div></div>
<div class="ttc" id="namespacecommon__tools_html_ae5d41b7419e727e4389ae0a37f684a7f"><div class="ttname"><a href="namespacecommon__tools.html#ae5d41b7419e727e4389ae0a37f684a7f">common_tools.save_dataset_to_pickle</a></div><div class="ttdeci">def save_dataset_to_pickle</div><div class="ttdef"><b>Definition:</b> <a href="common__tools_8py_source.html#l00048">common_tools.py:48</a></div></div>
<div class="ttc" id="namespacelearning__driver_html_a271d5c1e1b4364940878a76fce303bdc"><div class="ttname"><a href="namespacelearning__driver.html#a271d5c1e1b4364940878a76fce303bdc">learning_driver.classify_dataset</a></div><div class="ttdeci">def classify_dataset</div><div class="ttdoc">Reads the data set from the file name provided in order to perform learning and final classification ...</div><div class="ttdef"><b>Definition:</b> <a href="learning__driver_8py_source.html#l00056">learning_driver.py:56</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Dec 28 2014 15:51:54 for Machine Learning Final Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
